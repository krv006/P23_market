(function(a){var A=a(document),e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/i.test(navigator.userAgent);a.expr[":"].style=function(r,n,t){r=a(r);n=t[3].split(",");n=a.map(n,function(b){return a.trim(b)});t=n[0];n=n[1];if(r.css(t)==n)return!0};a.s3throttle=function(r,n,t){var b=a.s3throttle.timeouts[r];b&&clearTimeout(b);a.s3throttle.timeouts[r]=setTimeout(n,t)};a.s3escape=function(r){return a("<div>").text(r).html()};a.s3throttle.timeouts={};a.fn.s3center=function(){return this.each(function(){var r=
a(this),n=r.is(":visible");n||r.show();r.css({marginLeft:-r.outerWidth()/2,marginTop:-r.outerHeight()/2});n||r.hide()})};a.fn.s3deserializeArray=function(r){return this.each(function(){var n=a(this);a.each(r,function(){var t=n.find('[name="'+this.name+'"]');t.length&&(t.is("input[type=radio]")?t.filter('[value="'+this.value+'"]').trigger("click"):t.val(this.value).trigger("change"))})})};a.fn.caret=function(r,n){if(0!==this.length&&!this.is(":hidden")){if("number"===a.type(r))return n="number"===
a.type(n)?n:r,this.each(function(){this.setSelectionRange?this.setSelectionRange(r,n):this.createTextRange&&(t=this.createTextRange(),t.collapse(!0),t.moveEnd("character",n),t.moveStart("character",r),t.select())});if(this[0].setSelectionRange)r=this[0].selectionStart,n=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var t=document.selection.createRange();r=0-t.duplicate().moveStart("character",-1E5);n=r+t.text.length}return{begin:r,end:n}}};a.keys={};a.KEYS={Digit:[48,
57],Backspace:8,Comma:44,Point:46};a.each(a.KEYS,function(r,n){a.keys["is"+r]=function(t){return a.isArray(n)?n[0]<=t&&t<=n[1]:n===t}});a.fn.getVal=function(){var r=[];this.each(function(){var n=a(this).val();(n=parseFloat(n))||(n=0);r.push(n)});return r};a.fn.keyFilter=function(r,n){n=a.extend({type:"int",def:"",callback:a.noop},n);return this.each(function(){var t=a(this);t.on("keypress",r,function(b){var c=a(this);if(b.shiftKey&&","!==b.key&&(b.shiftKey||b.ctrlKey))return!1;if(0===b.which)return!0;
var d=a.keys.isDigit(b.which);var f=a.keys.isPoint(b.which)||a.keys.isComma(b.which);b=a.keys.isBackspace(b.which);if(!d&&!f&&!b||"int"===n.type&&f)return!1;b=c.val().replace(/,/g,".");d=c.caret();c.val(b);c.caret(d.begin,d.end);if(f&&-1!==b.indexOf("."))return!1});t.on("keyup",r,function(){var b=a(this);n.callback(b)});t.on("blur",r,function(){var b=a(this);""===b.val()&&(b.val(n.def),n.callback(b))})})};a.fn.getHeights=function(){var r=[],n=0;this.each(function(){var t=a(this);t.css("min-height",
0);t=t.height();r.push(t);t>n&&(n=t)});return{values:r,max:n}};a.fn.eachRow=function(r,n){var t=this.parent(),b=0,c;if(t.get(0)&&this.get(0)){t=t.width();var d=this.outerWidth(!0);n&&(t+=parseFloat(this.css("margin-right")));n=Math.floor(t/d);if(1<n)for(c=this.length;b<c;b+=n)t=b,d=b+n,d>c&&(d=c),r(this.slice(t,d),this.eq(t),this.eq(d-1))}return this};a.on=function(r,n){a.each(n,function(t,b){A.on(t,r,b)})};a.fn.s3tooltip=function(r){r=a.extend({data:function(){return this.alt||""},cls:"tooltip-1",
slide:!0,dir:"bottom"},r);var n=a("#shop2-tooltip");n.get(0)||(n=a('<div id="shop2-tooltip"></div>'),a("body").append(n));var t=this.selector,b=a(window),c,d,f,g;a.on(t,{mouseenter:function(h){if(h=r.data.call(this))c=b.width(),d=b.height(),n.html(h),n.addClass(r.cls),n.show(),f=n.outerWidth(!0),g=n.outerHeight(!0)},mouseleave:function(h){n.hide();n.removeClass(r.cls)},mousemove:function(h){var k=h.pageX;h=h.pageY;var l=A.scrollTop();k+f>c&&(k-=f);e&&0>k&&a("#shop2-tooltip").hasClass("shop2_multi_tooltip")&&
(k=20);"top"==r.dir?(h-=g,h<l&&(h=r.slide?l:h+g)):h+g>d+l&&(h=r.slide?d+l-g:h-g);n.css({left:k,top:h})}})}})(jQuery);
(function(a,A){var e={queue:{},callbacks:{},init:function(b){a.extend(this,b);this.my=this.my||{};a(function(){var c=e.queue;a.each(c,function(d){d=c[d];a.isFunction(d)&&d()})})}};-1!=document.location.search.indexOf("debug")&&(e.debug=!0);try{if(window.sessionStorage){var r=sessionStorage.getItem("shop2_current_url"),n=location.pathname+location.search;r!=n&&sessionStorage.setItem("shop2_back_url",r);sessionStorage.setItem("shop2_current_url",n)}e.back=function(){if(window.sessionStorage){var b=
sessionStorage.getItem("shop2_back_url");"null"===b&&(b="/")}else b=document.referrer;document.location=b||"/";return!1}}catch(b){e.back=function(){document.location=document.referrer}}e.on=function(b,c){var d=this;a.each(b.split(","),function(f,g){g=a.trim(g);d.callbacks[g]||(d.callbacks[g]=a.Callbacks());d.callbacks[g].add(c)})};e.off=function(b,c){this.callbacks[b]&&(c?this.callbacks[b].remove(c):this.callbacks[b].empty())};e.trigger=function(b){this.callbacks[b]&&this.callbacks[b].fireWith(A,
[].slice.call(arguments,1))};e.fire=function(b,c){a.isFunction(c)&&(this.callbacks&&this.callbacks[b]&&this.callbacks[b].has(c)||c.apply(A,[].slice.call(arguments,2)))};e.filter={_pre_params:"",init:function(){var b=decodeURIComponent(document.location.search);b&&=b.slice(1);this.str=b},escape:function(b){return b.replace(/(\[|\])/g,"\\$1")},remove:function(b,c){b+="=";"undefined"!==typeof c&&(b+=c);c=new RegExp("(.*)("+this.escape(b)+"[^&]*&*)(.*)","ig");this.str=this.str.replace(c,"$1$3").replace(/&$/,
"");return this},add:function(b,c){this.remove(b,c);this.str+=""!==this.str?"&":"";this.str+=b+"="+c;return this},has:function(b,c){b+="=";"undefined"!==typeof c&&(b+=c);return-1<this.str.indexOf(b)?!0:!1},get:function(b){b=new RegExp(this.escape(b)+"=([^&]*)");return(b=this.str.match(b))&&2==b.length?b[1]:!1},toggle:function(b,c){if("s[amount][min]"==b){if("0"===this.get("s[amount][max]"))return this.remove("s[amount][max]"),this.add("s[amount][min]",0),this;if("0"===this.get("s[amount][min]"))return this.remove("s[amount][min]"),
this.add("s[amount][max]",0),this}else if("s[amount][max]"==b){if("1"===this.get("s[amount][min]"))return this.remove("s[amount][min]"),this.add("s[amount][min]",0),this;if("0"===this.get("s[amount][min]"))return this.remove("s[amount][min]"),this.add("s[amount][min]",1),this}this.has(b,c)?this.remove(b,c):this.add(b,c);return this},sort:function(b){var c=new RegExp(this.escape("s[sort_by]")+"=([^&]*)");c=this.str.match(c);var d=b+" desc";b+=" asc";c=c&&1<c.length?c[1]:"";c=-1!==c.indexOf(d)?c.replace(d,
b):-1!==c.indexOf(b)?c.replace(b,d):""!==c?c+(","+d):d;this.remove("s[sort_by]");this.add("s[sort_by]",c);return this},go:function(){var b="";this.str&&(b+="?"==this.str.charAt(0)?"":"?",b+=this.str);document.location=document.location.pathname.replace(/\/p\/\d*/g,"")+b+document.location.hash;return!1},count:function(b){var c="/my/s3/api/shop2/?cmd=getSearchMatches&hash="+e.apiHash.getSearchMatches+"&ver_id="+e.verId+"&"+this.str+this._pre_params;e.trigger("beforeGetSearchMatches");a.get(c,function(d,
f){"success"==f&&"string"===a.type(d)&&(d=a.parseJSON(d));e.facets.enabled&&e.facets.aggregation(d);e.fire("afterGetSearchMatches",b,d,f);e.trigger("afterGetSearchMatches",d,f)})}};e.search={getParams:function(b,c){e.trigger("beforeGetFolderCustomFields");0<b&&(b="/my/s3/api/shop2/?cmd=getFolderCustomFields&hash="+e.apiHash.getFolderCustomFields+"&ver_id="+e.verId+"&folder_id="+b+"&"+decodeURIComponent(document.location.search).replace(/[^&]*=(&|$)/g,""),a.getJSON(b,function(d,f){e.fire("afterGetFolderCustomFields",
c,d,f);e.trigger("afterGetFolderCustomFields",d,f)}))}};e.facets={enabled:!1,aggs:null,_data:{},emptyClass:"empty-val",mask:'[data-name^="s[field]"][data-value="key"],[name="s[parentField][parentKey]"] [value="key"],[name="s[field]"] [value="key"],[data-name="s[field][index]"],[data-name="s[field][key]"],[name="s[field][key]"]',filter:{wrapper:".shop2-filter, #shop2-color-ext-list",items:"[data-name], [name], [name] [value]"},search:{wrapper:".shop2-block.search-form form, #shop2-color-ext-select",
items:"[data-name], [name], [name] [value]"},ignoreClear:function(b){this._data.attrName=b.attr("name")?b.attr("name"):b.parent().attr("name");this._data.isSelect="select"===b.prop("tagName").toLowerCase();this._data.val="option"===b.prop("tagName").toLowerCase()&&""===b.val();return/s\[(folder_id|products_per_page)\]/i.test(this._data.attrName)||this._data.isSelect||this._data.val},set:function(b){var c=e.facets[b];if(c){var d=a(c.wrapper);c=d.find(c.items);this._data.$wrapper=d;this.clearItems(c);
this.insertData(this.aggs);b="afterFacets"+b.charAt(0).toUpperCase()+b.slice(1);e.trigger(b,this.aggs)}},searchSetup:function(){if(this.search){var b=a(this.search.wrapper);if(b.length){var c=b.find(this.search.items),d=this,f="/my/s3/api/shop2/?cmd=getSearchMatches&hash="+e.apiHash.getSearchMatches+"&ver_id="+e.verId+"&",g=f+b.serialize();this.getDataSearch(g);c.on("change",function(h){"s[products_per_page]"!=h.target.name&&(g=f+b.serialize(),d.getDataSearch(g))})}}},getDataSearch:function(b){a.get(b,
function(c,d){"success"==d&&("string"===a.type(c)&&(c=a.parseJSON(c)),e.facets.aggregation(c),e.facets.set("search"))})},clearItems:function(b){var c=this.emptyClass,d=this,f,g;b.each(function(h,k){f=a(k);if(d.ignoreClear(f))return!0;g=f.prop("tagName").toLowerCase();switch(g){case "input":f.attr("placeholder","");break;case "option":f.attr("value")&&f.attr("disabled","disabled")}f.attr("data-param-val","0");f.addClass(c)})},aggregation:function(b){"object"===typeof b&&b.data.aggs&&(this.aggs=this.dataSetup(b.data.aggs));
return this.aggs},dataSetup:function(b){var c=b.cf,d;for(d in c){var f=c[d];a.isArray(f)&&!f.length&&delete c[d]}return b},insertData:function(b,c,d){a.each(b,a.proxy(function(f,g){if("object"===typeof g)this.insertData(g,f,c);else{this._data.$item=this.getItem(c,f,d);if(!this._data.$item.length||!g&&0!=g)return!0;switch(this._data.$item.prop("tagName").toLowerCase()){case "input":this._data.$item.attr("placeholder",g);break;case "option":this._data.$item.removeAttr("disabled")}this._data.$item.attr("data-param-val",
g);this._data.$item.removeClass(this.emptyClass)}},this))},getItem:function(b,c,d){this._data.selector=d&&"cf"!==d?this.mask.replace(/parentField/g,d).replace(/parentKey/g,b).replace(/key/g,c):this.mask.replace(/field/g,b).replace(/key/g,c);return this._data.$wrapper.find(this._data.selector)},setMask:function(b){this.mask=b},setEmptyClass:function(b){this.emptyClass=b},setContainers:function(b,c){this[b]=c}};e.cart={add:function(b,c,d){e.trigger("beforeCartAddItem");a.post("/my/s3/api/shop2/?cmd=cartAddItem",
{hash:e.apiHash.cartAddItem,ver_id:e.verId,kind_id:b,amount:c},function(f,g){e.fire("afterCartAddItem",d,f,g);e.trigger("afterCartAddItem",f,g)},"json")},addMultiple:function(b,c){e.trigger("beforeCartAddMultipleItems");b=a.extend({hash:e.apiHash.cartAddItem,ver_id:e.verId},b);a.post("/my/s3/api/shop2/?cmd=cartAddItem",b,function(d,f){e.fire("afterCartAddMultipleItems",c,d,f);e.trigger("afterCartAddMultipleItems",d,f)},"json")},remove:function(b,c){b=b.toString().replace(/"/g,'\\"').replace(/'/g,
'"');b=a.parseJSON(b);e.trigger("beforeCartRemoveItem");a.getJSON("/my/s3/api/shop2/?cmd=cartRemoveItem",{hash:e.apiHash.del,ver_id:e.verId,kind_id:b},function(d,f){e.fire("afterCartRemoveItem",c,d,f);e.trigger("afterCartRemoveItem",d,f)});return!1},clear:function(){e.trigger("beforeCartClear");a.get(e.uri+"?mode=cart&action=cleanup",function(b,c){e.trigger("afterCartClear",b,c)})},update:function(b,c){b=b.serialize();e.trigger("beforeCartUpdate");a.post("/my/s3/api/shop2/?cmd=cartUpdate","ver_id="+
e.verId+"&hash="+e.apiHash.up+"&"+b,function(d,f){e.fire("afterCartUpdate",c,d,f);e.trigger("afterCartUpdate",d,f)});return!1},addCoupon:function(b,c){e.trigger("beforeCartAddCoupon");a.getJSON("/my/s3/xapi/public?method=cart/addCoupon",{param:{coupon:b}},function(d,f){e.fire("afterCartAddCoupon",c,d,f);e.trigger("afterCartAddCoupon",d,f)});return!1},removeCoupon:function(b,c){e.trigger("beforeCartRemoveCoupon");a.getJSON("/my/s3/xapi/public?method=cart/removeCoupon",{param:{coupon:b}},function(d,
f){e.fire("afterCartRemoveCoupon",c,d,f);e.trigger("afterCartRemoveCoupon",d,f)})}};e.delivery={deligate:!1,ymapsMap:null,ymapsData:[],ymapsIconsData:{"default":"/g/shop2v2/default/images/map-pin-grey.svg",spsr:"/g/shop2v2/default/images/map-pin-red.svg",dellin:"/g/shop2v2/default/images/map-pin-purple.svg",edostavka:"/g/shop2v2/default/images/map-pin-green.svg",pickpoint:"/g/shop2v2/default/images/map-pin-grey.svg",boxberry:"/g/shop2v2/default/images/map-pin-boxberry.svg",delica:"/g/shop2v2/default/images/map-pin-grey.svg",
selected:"/g/shop2v2/default/images/map-pin-blue.svg"},calc:function(b,c,d){e.trigger("beforeDeliveryCalc");a.getJSON("/my/s3/api/shop2/?cmd=deliveryCalc",{hash:e.apiHash.calc,ver_id:e.verId,attach_id:b,params:c},function(f,g){e.fire("afterDeliveryCalc",d,f,g);e.trigger("afterDeliveryCalc",f,g)})},YmapsInit:function(b){var c=Object.keys(e.delivery.ymapsData).length,d=a(".baloon-content-localize");d.data("point-text");var f=d.data("term-text");d.data("price-text");d.data("address-text");var g=d.data("phone-text"),
h=d.data("worktime-text"),k=d.data("url-text"),l=d.data("more-text"),m=d.data("choose-text");if(!c)return a(".shop2-delivery--item__tab.points").addClass("disabled"),!1;c=a.parseJSON(a("#dadata").val());var q=[c.geo_lat,c.geo_lon];ymaps.ready(function(){e.delivery.ymapsMap=new ymaps.Map(b,{center:q,zoom:11,controls:["zoomControl"]});var p=a("[data-deligate-address-index]").data("deligate-address-index")||0,v=ymaps.templateLayoutFactory.createClass('<div class="delivery-baloon-content"><h3>$[properties.address]</h3><div class="buttons"><button type="button" class="shop2-btn" id="balloon-select">'+
m+'</button>[if properties.site]<a target="_blank" class="shop2-btn" href="$[properties.site]">'+l+'</a>[endif]</div><div class="note-block">[if properties.term] <p><span>'+f+':</span><strong class="term">$[properties.term]</strong></p>[endif] <p>$[properties.cost]</p> </div>[if properties.phone]<div class="phone"><span>'+g+':</span>$[properties.phone]</div>[endif][if properties.worktime]<div class="worktime"><span>'+h+':</span>$[properties.worktime]</div>[endif][if properties.desc]<div class="desc"><span>'+
k+':</span>$[properties.desc]</div>[endif]<form data-attach_id="$[properties.attach_id]"><input type="hidden" name="delivery_type" value="$[properties.delivery_type]"><input class="point-address" type="hidden" name="$[properties.attach_id]['+p+']" value="$[properties.address]"><input type="hidden" name="$[properties.attach_id][deligate][tarif]" class="tariff" value="$[properties.tariff_hash]"><input type="hidden" name="$[properties.attach_id][deligate][terminal]" value="$[properties.id]"></form></div>',
{build:function(){v.superclass.build.call(this);a("#balloon-select").bind("click",this.onCounterClick)},clear:function(){a("#balloon-select").unbind("click",this.onCounterClick);v.superclass.clear.call(this)},onCounterClick:function(u){u.preventDefault();var w=a(this).parents(".delivery-baloon-content:first");u=w.find("form");var y=w.find("h3").text(),B=w.find("label.cost input:checked"),G=B.parent().data("cost");w=w.find(".term").text();var D=u.data("attach_id"),z=a("#shop2-order-delivery");z.find(".option-label");
z.find(".option-type");z.find(".option-details");z.find(".shop2-delivery--item__tab.points");z=a(e.delivery.ymapsMap.container._parentElement).next();var E=u.find("input.point-address").val(),F=a(e.delivery.ymapsMap.container._parentElement).parents(".option-details:first");a("#delivery_id_deligate").val(D);u.find("input.tariff").val(B.val());z.find(".fields").html(u.html());z.find(".point-name").html(y);z.find(".point-cost").html(G);z.find(".point-term").html(w);z.find(".point-address").html(E);
F.addClass("selected");a("html, body").scrollTop(F.parent().offset().top-60);if(6==e.shop2_cart_order_payments){let C={};C.property_attach={delivery_type:u.find('[name="delivery_type"]').val(),deligate:{tarif:B.val(),terminal:u.find('[name="900[deligate][terminal]"]').val()}};C.property_attach["0"]=E;C.value=D;a(this).closest(".option-details").find(".g-form-field__value .g-form-control-value").each(function(H,I){C.property_attach[`${H+1}`]=I.value});e.queue.orderGetPayments(!0,C)}e.delivery.ymapsMap.balloon.close();
u=e.my.on_shop2_btn?".shop2-btn":".g-button";a(`.form-item ${u}.shop2-disabled`).length&&(a(`.form-item ${u}.shop2-disabled`).removeClass("shop2-disabled"),a(".order_design_five").addClass("hide"))}}),x=new ymaps.GeoObjectCollection;a.each(e.delivery.ymapsData[b],function(u,w){u=e.delivery.ymapsIconsData[b]||e.delivery.ymapsIconsData["default"];w.service_code==b&&(w=new ymaps.Placemark(w.coords,w,{balloonContentLayout:v,iconLayout:"default#image",iconImageHref:u,iconImageSize:[26,36],iconImageOffset:[-13,
-36],balloonMaxWidth:530,balloonPanelMaxMapArea:"Infinity",balloonMinHeight:330,balloonshadow:!1}),w.events.add("click",function(y){for(var B=0;B<x.getLength();B++)x.get(B).options.set("iconImageHref",e.delivery.ymapsIconsData["default"]);y.get("target").options.set("iconImageHref",e.delivery.ymapsIconsData.selected)}),x.add(w))});e.delivery.ymapsMap.geoObjects.add(x);e.delivery.ymapsMap.container.fitToViewport();e.delivery.ymapsMap.behaviors.disable("multiTouch")})},changeDeliveryPoint:function(b,
c){b=a(b).parents(".option-details:first");e.delivery.ymapsMap&&(e.delivery.ymapsMap.destroy(),e.delivery.ymapsMap=null);b.find(".map-select select option:first").prop("selected",!0);b.find(".map-select select").trigger("refresh");b.find(".deligate_points_fields .fields").empty();b.removeClass("selected");a("html, body").scrollTop(b.parent().offset().top-60);e.delivery.YmapsInit(c);c=e.my.on_shop2_btn?".shop2-btn":".g-button";a(`.form-item ${c}`).length&&(a(`.form-item ${c}`).addClass("shop2-disabled"),
a(".order_design_five").removeClass("hide"));return!1},selectSuggestion:function(b,c){a.ajax({url:"/my/s3/xapi/public/?method=deligate/suggestAddress",type:"POST",dataType:"json",data:JSON.stringify({query:b,count:1}),success:function(d){d.result.suggestions&&(d.result.suggestions[0].data.source=b);c||(a("#dadata").val(JSON.stringify(d.result.suggestions[0].data)),a("#address").val(d.result.suggestions[0].value));a("#shop2-deligate-calc").trigger("click")}})}};e.compare={add:function(b,c){this.action("add",
b,c)},remove:function(b,c){this.action("del",b,c)},clear:function(b){this.action("clear",null,b)},action:function(b,c,d){var f=a.camelCase("Compare-"+b);e.trigger("before"+f);a.post("/my/s3/xapi/public/?method=shop2/compare",{kind_id:c,action:b},function(g,h){e.fire("after"+f,d,g.result,h);e.trigger("after"+f,g.result,h)})}};e.product={getProductListItem:function(b,c,d,f){var g="/my/s3/api/shop2/?cmd=getProductListItem&hash="+e.apiHash.getProductListItem+"&ver_id="+e.verId;e.trigger("beforeGetProductListItem");
a.post(g,{product_id:b,kind_id:c,params:f},function(h,k){e.fire("afterGetProductListItem",d,h,k);e.trigger("afterGetProductListItem",h,k)})},checkMetaItemValue:function(b,c,d){b=b[c];if("undefined"==b||null==b)return!1;if(b==d)return!0;if(b instanceof Object)for(var f in b)if(b[f]==d)return!0;return!1},getMetaItemValue:function(b,c){b=b[c];if("undefined"===a.type(b))return!1;if("object"===a.type(b)){if("undefined"!==a.type(b.v))return b.v;if("undefined"!==a.type(b.image_id))return b.image_id}return b},
findKindId:function(b,c,d,f,g,h){var k,l=0,m=a.extend(!0,{},e.productRefs[b]);h&&a.each(m,function(x){h[x]||delete m[x]});if(1==c.length)return c[0];"object"!==a.type(g)&&(g=a.parseJSON(g));b=0;for(k=c.length;b<k;b+=1){var q=Number(c[b]);var p=0;a.each(m,function(x,u){a.each(u,function(w){x==d?w==f&&(p+=1):-1!==String(m[x][w]).indexOf(q)&&(p+=1,g&&e.product.checkMetaItemValue(g,x,w)&&(p+=1))})});if(p>l){var v=q;l=p}}return v},getNodeData:function(b,c,d){var f=!1;"SELECT"==b.tagName?f=a(b.options[b.selectedIndex]).data(c):
1==b.nodeType&&(f=a(b).data(c));d&&(f=this.decodeFieldData(f));return f},decodeFieldData:function(b){if("string"!==a.type(b))return[b];b=b.split(",");return a.map(b,function(c){return a.trim(c)})},hasKindId:function(b,c){var d;if(b){var f=0;for(d=c.length;f<d;f+=1)if(-1!==b.indexOf(c[f]))return!0}return!1},deleteUploadProduct:function(b,c){var d=new FormData;d.append("kind_id",c);d.append("code",b);a.ajax({url:"/my/s3/xapi/public/?method=shop2/removeUploadFileProduct",type:"post",dataType:"json",
processData:!1,contentType:!1,data:d,success:function(f){f="undefined"!=typeof f.result?f.result:f;f.success?document.location.reload(!0):alert(f.error)}})},uploadProduct:function(b,c,d,f){var g=new FormData,h=a("#_upload_"+b+c).parent(),k=a("#_upload_"+b+c).get(0).files,l='<span class="delete-upload-file shop2-btn" onclick="shop2.product.deleteUploadProduct(\''+b+"',"+c+')">\u0443\u0434\u0430\u043b\u0438\u0442\u044c</span>';if(0==k.length)return alert(_s3Lang.JS_FILES_NOT_SELECTED),!1;a.each(k,function(m,
q){g.append(b,q)});g.append("kind_id",c);g.append("code",b);d&&(g.append("image",!0),f&&g.append("params",JSON.stringify(f)));a.ajax({url:"/my/s3/xapi/public/?method=shop2/uploadFileProduct",type:"post",dataType:"json",processData:!1,contentType:!1,data:g,success:function(m){m="undefined"!=typeof m.result?m.result:m;m.success?d?h.empty().html('<img src="'+m.data+'">'+l):h.empty().html('<a href="/u/'+m.data+'">'+m.data+"</a>"+l):alert(m.error)}})},uploadInCart:function(b,c,d,f,g){var h=new FormData,
k=a("#_upload_in_cart_"+b+"_"+c+"_"+d).parent(),l=a("#_upload_in_cart_"+b+"_"+c+"_"+d).get(0).files,m='<span class="delete-upload-file shop2-btn" onclick="shop2.product.deleteUploadInCart('+b+", "+c+", '"+d+"')\">\u0443\u0434\u0430\u043b\u0438\u0442\u044c</span>";if(0==l.length)return alert(_s3Lang.JS_FILES_NOT_SELECTED),!1;a.each(l,function(q,p){h.append(d,p)});h.append("kind_id",b);h.append("code",d);h.append("pos",c);f&&(h.append("image",!0),g&&h.append("params",JSON.stringify(g)));a.ajax({url:"/my/s3/xapi/public/?method=shop2/uploadFileProductInCart",
type:"post",dataType:"json",processData:!1,contentType:!1,data:h,success:function(q){q="undefined"!=typeof q.result?q.result:q;q.success?f?k.empty().html('<img src="'+q.data+'">'+m):k.empty().html('<a href="/u/'+q.data+'">'+q.data+"</a>"+m):alert(q.error)}})},deleteUploadInCart:function(b,c,d){var f=new FormData;f.append("kind_id",b);f.append("code",d);f.append("pos",c);a.ajax({url:"/my/s3/xapi/public/?method=shop2/removeUploadFileProductInCart",type:"post",dataType:"json",processData:!1,contentType:!1,
data:f,success:function(g){g="undefined"!=typeof g.result?g.result:g;g.success?document.location.reload(!0):alert(g.error)}})},productDatePicker:function(){a(".shop2-date_interval , .shop2-date").each(function(b,c){a(this).datepicker({minDate:0,changeMonth:!1,numberOfMonths:1,showOn:"button",buttonImage:"/g/shop2v2/default/images/shop2_calendar.svg",buttonImageOnly:!1,buttonText:"Select date"})})}};e.options={amountDefaultValue:1,amountDefaultInc:1,amountType:"float",msgTime:3E3,printCSS:"/g/shop2v2/default/css/print.less.css"};
e.user={activate:function(b,c){var d=a(c);d.attr("disabled",!0);a.post("/my/s3/xapi/public/?method=user/reactivation",{user_id:b},function(){var f=d.parent(),g=a("<div>").addClass("shop2-info").html(window._s3Lang.ACTIVATION_MAIL_SENT);d.hide();f.append(g)})}};e.orderCancelling={alert:function(){var b=a(".order-cancelling"),c=b.data("href"),d=b.data("cancellingTitle"),f=b.data("cancellingButtonTitle");b=b.data("cancellingClose");e.alert('<div class="order-cancel-title">'+d+'</div><div class="order-cancel-buttons"><a class="shop2-btn" href="'+
c+'">'+f+'</a><a class="shop2-alert-close" onclick="shop2.alert.hide(); return false;" href="#">'+b+"</a></div>","","shop2-alert--warning order-cancel")}};a(document).on("click",".order-cancelling",function(b){b.preventDefault();e.orderCancelling.alert()});e.orderRepeat={alert:function(b){var c=b.filter(".order-repeat");b=c.data("href");var d=c.data("repeatTitle"),f=c.data("repeatButtonTitle");c=c.data("repeatClose");e.alert('<div class="order-repeat-title">'+d+'?</div><div class="order-repeat-buttons"><a class="shop2-btn" href="'+
b+'">'+f+'</a><a class="shop2-alert-close" onclick="shop2.alert.hide(); return false;" href="#">'+c+"</a></div>","\u0417\u0430\u043a\u0440\u044b\u0442\u044c","shop2-alert--warning order-cancel")}};a(document).on("click",".order-repeat",function(b){b.preventDefault();e.orderRepeat.alert(a(this))});e.paymentChange={alert:function(b){b=b.filter(".order-payment-change");var c=b.data("href"),d=b.data("title"),f=b.data("button-title"),g=b.data("close");a.ajax({url:c,type:"POST",dataType:"json",data:{},
success:function(h){h='<div class="payment-change-title">'+d+'</div><div class="error"></div>'+h.data+'<div class="payment-change-buttons"><a class="shop2-btn" onclick="shop2.paymentChange.save(\''+c.replace("act=list","act=save")+'\');" href="#">'+f+'</a><a class="shop2-alert-close" onclick="shop2.alert.hide(); return false;" href="#">'+g+"</a></div>";e.alert(h,g,"shop2-alert--warning order-cancel")}})},save:function(b){var c=a("#shop2-alert-body .shop2-payment-options").serialize();a.ajax({url:b+
"&"+c,type:"POST",dataType:"json",data:{},success:function(d){"OK"===d.data?document.location.reload():a("#shop2-alert-body .error").html(d.data)}});return!1}};a(document).on("click",".order-payment-change",function(b){b.preventDefault();e.paymentChange.alert(a(this))});a(document).on("click.getPromoLink",".get-promo-link",function(b){b.preventDefault();b=a(this).data("ver-id");var c=a(this).data("cmd"),d=e.apiHash.getPromoProducts,f=a(this).data("is-main"),g=a(this).data("kind-id"),h=a(this).data("discount-id");
a.ajax({url:"/my/s3/api/shop2/?ver_id="+b+"&cmd="+c+"&hash="+d+"&kind_id="+g+"&discount_id="+h+"&is_main="+f,type:"POST",dataType:"json",data:{},success:function(k){e.alert(k.data,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","promo-products-list")}})});a(document).on("click.promoPagelist",".promo-products-list li",function(b){b.preventDefault();b=a(this).find("a").attr("href");a.ajax({url:b,type:"POST",dataType:"json",data:{},success:function(c){e.alert(c.data,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",
"promo-products-list")}})});e.msg=function(b,c){var d=a("#shop2-msg"),f=c.offset(),g=c.outerWidth(!0);c=c.outerHeight(!0);d.get(0)||(d=a('<div id="shop2-msg">'),a(document.body).append(d),d=a("#shop2-msg"));d.html(b).show();b=d.outerWidth();g=f.left+g;c=f.top+c;g+b>a(window).width()&&(g=f.left-b);d.css({left:g,top:c});a.s3throttle("msg",function(){d.hide()},e.options.msgTime)};e.queue={cookiesDisabled:function(){navigator&&0==navigator.cookieEnabled&&a(".shop2-cookies-disabled").html("<p>\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435! \u0414\u043b\u044f \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u044b \u0443 \u0412\u0430\u0441 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0432\u043a\u043b\u044e\u0447\u0435\u043d\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0430 cookie. \u0412 \u0441\u043b\u0443\u0447\u0430\u0435 \u0435\u0441\u043b\u0438 \u043f\u043e \u043a\u0430\u043a\u0438\u043c-\u043b\u0438\u0431\u043e \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0430 \u0438 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 cookie \u0443 \u0412\u0430\u0441 \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e.</p>").removeClass("hide")},
cartState:function(){try{window.sessionStorage}catch(b){return}window.chrome&&sessionStorage&&e.my.save_cart_state&&(readCookie("s3s2_cart")||(sessionStorage.removeItem("cart-reload"),sessionStorage.removeItem("cart-state")),1==sessionStorage.getItem("cart-reload")&&(sessionStorage.removeItem("cart-reload"),sessionStorage.setItem("cart-state",a("<div>").append(a("#shop2-cart-preview").clone()).html())),e.on("afterCartAddItem",function(b,c){b=b.data;"success"!=c&&(b="");sessionStorage.setItem("cart-state",
b)}),e.on("afterCartRemoveItem, afterCartUpdate",function(){sessionStorage.setItem("cart-reload",1)}),a(window).on("pageshow",function(){var b=sessionStorage.getItem("cart-state");b&&a("#shop2-cart-preview").replaceWith(b)}))},keys:function(){a(document).keyFilter("input.shop2-input-int");a(document).keyFilter("input.shop2-input-float",{type:"float"})},heights:function(){a(".product-list-thumbs").each(function(){a(this).find(".product-item-thumb").eachRow(function(b){var c=b.find(".product-name");
c.css("min-height",0);var d=c.getHeights();c.css("min-height",d.max);c=b.find(".product-amount");if(c.length){c.css("margin-top",0);var f=b.getHeights();b.each(function(g){a(this).find(".product-amount").css("margin-top",f.max-f.values[g])})}else b.each(function(){var g=a(this),h=g.find(".shop2-product-actions");h.length||(h=g.find(".product-bot"));var k=h.data("padding-top");"undefined"===a.type(k)&&(k=parseInt(g.css("padding-top")),h.data("padding-top",k));h.css("padding-top",k)}),f=b.getHeights(),
b.each(function(g){var h=a(this),k=h.find(".shop2-product-actions");k.length||(k=h.find(".product-bot"));h=k.data("padding-top");k.css("padding-top",f.max-f.values[g]+h)})})})},resize:function(){a(window).resize(function(){e.queue.heights()})},product:function(){e.product._reload=function(b){var c=a(b),d=e.product.getNodeData(b,"kinds",!0),f=e.product.getNodeData(b,"name"),g=e.product.getNodeData(b,"value"),h=c.closest("form"),k=h.get(0),l={},m={};b=!1;if(d&&"undefined"!==a.type(f)&&"undefined"!==
a.type(g)&&k){var q=h.find("input[name=meta]").val();k=h.find("input[name=product_id]").val();h.find("[name=submit]").prop("disabled",!0);h.find("select.shop2-cf>option, li.shop2-cf, li.shop2-color-ext-selected, ul.shop2-color-ext-list>li").each(function(){var p=a(this).data("name");p&&(l[p]=!0)});d=e.product.findKindId(k,d,f,g,q,l);d||(d=h.find("[name=kind_id]").val(),b=!0);h.find(".js-calc-custom-fields.additional-cart-params").each(function(){var p=a(this).attr("name");m[p]=a(this).find("option:selected").data("item-id")});
h.find(".js-calc-custom-fields.shop2-color-ext-selected").each(function(){var p=a(this).data("name");m[p]=a(this).data("item-id")});b?e.product.getProductListItem(k,d,function(p,v){"success"===v&&(v=a.trim(p.data.body),p=a(".product-price",v).html(),v=a(".shop2-product-actions",v).html(),h.find(".product-price").html(p),h.find(".shop2-product-actions").html(v),e.trigger("afterProductReloaded"),e.queue.heights())},m):"product"===e.mode?document.location=e.uri?e.uri+"/product/"+d:document.location.href.replace(/\/product\/.+/,
"/product/"+d):e.product.getProductListItem(k,d,function(p,v){"success"===v&&(e.trigger("afterProductReloaded"),v=c.closest(".shop2-product-item"),v.hide(),p=a.trim(p.data.body),a(p).insertBefore(v),v.remove(),e.queue.heights())},m)}};a.on("select.shop2-cf",{change:function(){e.product._reload(this)}});a.on("li.shop2-cf:not(.active-color, .active-texture)",{click:function(){e.product._reload(this)}});a.on("span.shop2-path-show-folders",{click:function(b){b.preventDefault();a(this).next().show();a(this).hide()}})},
addToCart:function(){a(document).on("click",".shop2-product-btn:not(.preorder-btn-js)",function(b){var c=a(this),d=c.closest("form"),f=d.get(0);d=d.find(".additional-cart-params");var g=d.length,h=f.amount.value;f=f.kind_id.value;b.preventDefault();if(g)for(h={amount:h},b=0;b<g;b+=1){var k=d[b];k.value&&(h[k.name]=k.value)}e.cart.add(f,h,function(l){a("#shop2-cart-preview").replaceWith(l.data);l.errstr?e.msg(l.errstr,c):e.msg(window._s3Lang.JS_SHOP2_ADD_CART_WITH_LINK.replace("%s",e.uri+"/cart"),
c);l.panel&&a("#shop2-panel").replaceWith(l.panel)})})},amount:function(){function b(d,f,g,h){d=0<g?d+g*h:d+e.options.amountDefaultInc*h;return d=d.toFixed(2)-0}var c=a(document);c.on("click",".amount-minus",function(){var d=a(this).siblings("input:text"),f=d.getVal(),g=parseFloat(d.data("min")),h=parseFloat(d.data("multiplicity"));f&&=f[0];g&&f<=g||(f=b(f,g,h,-1),0<g?f<=g&&(f=g):f<=e.options.amountDefaultValue&&(f=e.options.amountDefaultValue),d.val(f),d.trigger("change"))});c.on("click",".amount-plus",
function(){var d=a(this).siblings("input:text"),f=d.getVal(),g=parseFloat(d.data("min")),h=parseFloat(d.data("multiplicity"));f&&=f[0];f=b(f,g,h,1);d.val(f);d.trigger("change")});c.on("change",".shop2-product-amount input:text",function(){var d=a(this),f=d.data("kind"),g=d.data("max"),h=Number(d.val()),k=parseFloat(d.data("min")),l=parseFloat(d.data("multiplicity"));f&&0<g&&(f=Number(d.val()),f>g&&(g=g-f+h,d.val(g),g=g.toFixed(2)-0,e.msg(_s3Lang.JS_AVAILABLE_ONLY+" "+g,d)));if(k||l)l&&(g=(h-k)%l,
h=g<l/2?h-g:h+(l-g),1===k&&1<l&&h--,h=h.toFixed(2)-0,d.val(h)),0<k?k&&h<=k&&d.val(k):h<=e.options.amountDefaultValue&&d.val(amountDefaultValue)});c.keyFilter(".shop2-product-amount input:text",{type:e.options.amountType})},kindAvailable:function(){var b=function(f,g){a.ajax({url:"/my/s3/xapi/public/?method=shop2/addKindEmailNotification",method:"post",xhrFields:{withCredentials:!0},data:f,success:function(h){g(h)}})},c,d;a(document).on("click",".preorder-btn-js",function(f){f.preventDefault();c={};
d=a(this);c.kind_id=d.data("product-kind_id");c.email=d.data("user-email")||0;e.alert(`
                        <div class="preorder-form-wrap preorder-popup">
                            <form class="preorder-popup-body" action="/my/s3/xapi/public/?method=shop2/addKindEmailNotification" method="get">
                                <h2 class="preorder-popup-title">
                                    ${e.my.preorder_form_title||"\u0423\u0437\u043d\u0430\u0442\u044c \u043e \u043f\u043e\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u0438"}
                                </h2>
                                <div class="preorder-popup-text preorder-field type-html">
                                    ${e.my.preorder_form_text||"\u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u043f\u043e\u0447\u0442\u0443 \u0438 \u043c\u044b \u043d\u0430\u043f\u0438\u0448\u0435\u043c \u0432\u0430\u043c, \u043a\u043e\u0433\u0434\u0430 \u0442\u043e\u0432\u0430\u0440 \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u0432 \u043d\u0430\u043b\u0438\u0447\u0438\u0438."}
                                </div>
                                ${c.email?`
                <div class="preorder-field preorder-email">
                    <span class="preorder-email_text">
                        ${e.my.preorder_email_text||"\u0414\u0430\u043d\u043d\u044b\u0439 email \u0443\u043a\u0430\u0437\u0430\u043d \u043f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438."}
                    </span>
                    <div class="preorder-email-input">
                        <div class="preorder-field-title">E-mail: <span class="preorder-mark">*</span></div>
                        <div class="preorder-field-value">
                            <input type="text" name="email" required value="${c.email}">
                        </div>
                    </div>
                </div>
                `:'\n                <div class="preorder-field preorder-email">\n                    <div class="preorder-email-input">\n                        <div class="preorder-field-title">E-mail: <span class="preorder-mark">*</span></div>\n                        <div class="preorder-field-value">\n                            <input type="text" name="email" required value="">\n                        </div>\n                    </div>\n                </div>\n                '}
                                <input type="hidden" name="kind_id" value="${c.kind_id}">

                                <div class="preorder-field preorder-field-button preorder_send">
                                    <button type="submit" class="shop2-btn">${e.my.preorder_form_submitt||"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}</button>
                                </div>

                            </form>
                            <div class="block-recaptcha"></div>
                        </div>
                        <div class="preorder-form-close"></div>
                            `,"close","preorder-alert")});a(document).on("click",".preorder-form-close",function(f){a("#shop2-alert-ok").click()});a(document).on("submit",".block-recaptcha form",function(f){f.preventDefault();f=a(this).serializeArray();for(let g=0;g<f.length;g++)"_sitekey"==f[g].name&&(c._sitekey=f[g].value),"g-recaptcha-response"==f[g].name&&(c["g-recaptcha-response"]=f[g].value);b(c,g=>{d.get(0).setAttribute("disabled","disabled");a(".preorder-form-wrap").html(`
                    <h3 class="preorder-popup-success">
                        ${e.my.preorder_form_success||"\u0421\u043f\u0430\u0441\u0438\u0431\u043e!"}
                    </h3>
                `);d.closest("form").length&&(g=d.closest("form").find(".favorite_btn"),g.length&&!g.is(":hidden")&&g.trigger("click"))})});a(document).on("submit",".preorder-popup-body",function(f){f.preventDefault();var g=a(this);c.email=this.email.value;/^[\w-\.]+@[\w-]+\.[a-z]{2,4}$/i.test(c.email)?a.get("/my/s3/xapi/public/?method=shop2/addKindEmailNotification",function(h){h=h.result.html.match(new RegExp(/<body[^>]*>(.*?)<\/body>/ig));g.parent(".preorder-popup").find(".block-recaptcha").html(h)}):
g.find(".preorder-email").hasClass("field-error")||g.find(".preorder-email").addClass("field-error").find(".preorder-email-input .preorder-field-value").before('<div class="error-message">\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u0430\u0434\u0440\u0435\u0441\u0430 \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0447\u0442\u044b</div>')})},discounts:function(){a(document).on("click",".shop2-product-actions dt",function(b){var c=
a(this),d=c.next();c=c.position().left;b.stopPropagation();d.is(":hidden")&&(a(".shop2-product-actions dd").hide(),d.show(),d.css("left",c))});a(document).on("click",".close-desc-action",function(b){var c=a(this).closest("dd");b.stopPropagation();c.hide()});a(document).on("click",function(){a(".shop2-product-actions dd").hide()})},question:function(){a(document).on("mouseenter",".price-old.question, .shop2-cart-total .question",function(){var b=a(this),c=b.next().show();b=b.position();var d=c.outerHeight(!0);
c.css({top:b.top-d-5,left:b.left})}).on("mouseleave",".price-old.question, .shop2-cart-total .question",function(){a(this).next().hide()})},tabs:function(){var b=a(".shop2-product-tabs li"),c=b.find("a"),d=a(".shop2-product-desc > div");c.on("click",function(f){var g=a(this),h=g.attr("href");f.preventDefault();b.removeClass("active-tab");g.parent().addClass("active-tab");d.removeClass("active-area");a(h).addClass("active-area")})},filter:function(){var b=a(".shop2-filter"),c=a(".result");e.filter.init();
e.on("afterGetSearchMatches",function(d,f){0===d.data.total_found?c.addClass("no-result"):c.removeClass("no-result");e.facets.enabled&&e.facets.set("filter");a("#filter-result").html(d.data.total_found);c.removeClass("hide")});b.find(".param-val").on("click",function(d){var f=a(this),g=f.data("name"),h=f.data("value");d.preventDefault();f.toggleClass("active-val");e.filter.toggle(g,h);e.filter.count()});b.find("select").on("change",function(){var d=a(this),f=this.name;d=d.val();e.filter.add(f,d);
e.filter.count()});b.find("input:text").keyup(function(){var d=a(this),f=d.attr("name");a.s3throttle("filter: "+f,function(){var g=d.val();e.filter.add(f,g);e.filter.count()},500)});b.find(".shop2-filter-go").on("click",function(d){d.preventDefault();e.filter.go()})},sort:function(){var b=a(".sorting");b.find(".sort-param").on("click",function(c){var d=a(this).data("name");c.preventDefault();e.filter.sort(d);e.filter.go()});b.find(".sort-reset").on("click",function(c){c.preventDefault();e.filter.remove("s[sort_by]");
e.filter.go()})},views:function(){a(".view-shop a").on("click",function(b){var c=a(this).data("value");b.preventDefault();e.filter.remove("view");e.filter.add("view",c);e.filter.go()})},toggle:function(){function b(c,d,f,g){a(document).on("click",d+" "+c,function(h){var k=a(d);h.preventDefault();k.hasClass(f)?(k.removeClass(f),eraseCookie(g)):(k.addClass(f),createCookie(g,1,7))})}b(".block-title",".cart-preview","opened","cart_opened");b(".block-title",".search-form","opened","search_opened");b(".block-title",
".login-form ","opened","login_opened")},search:function(){var b=a("#shop2_search_custom_fields"),c=a("#shop2_search_global_fields");e.on("afterGetFolderCustomFields",function(d,f){b.html(d.data);c.find("input, select").prop("disabled",!0);c.hide()});a("#s\\[folder_id\\]").on("change",function(){var d=a(this).val();d?e.search.getParams(d):(b.html(""),c.find("input, select").prop("disabled",!1),c.show())}).trigger("change");e.facets.enabled&&!e.my.lazy_search_activation&&e.facets.searchSetup()},cart:function(){function b(){c.show()}
var c=a(".shop2-cart-update"),d=a(".shop2-cart-table"),f=a("#shop2-cart");e.on("afterCartRemoveItem, afterCartUpdate",function(){document.location.reload()});var g;["keypress","keyup","keydown"].forEach(function(h){if("on"+h in document)return g=h,!1});d.find("input:text").on(g,function(h){13==h.keyCode?e.cart.update(f):b()});a(document).on("click","li.param-value:not(.shop2-color-ext-selected)",function(){b()});a(document).on("change","select.param-value",function(){b()});d.find(".amount-minus, .amount-plus").on("click",
b);c.on("click",function(h){h.preventDefault();e.cart.update(f);return!1});a(".cart-delete a").on("click",function(h){var k=a(this).data("id");h.preventDefault();e.cart.remove(k)});a(document).on("click","#shop2-deligate-calc",function(h){var k={},l=a("#shop2-order-delivery"),m=l.find(".shop2-delivery--item__tab");a("#shop2-perfect-form").find("input, textearea, select").each(function(){a(this);"INPUT"===this.tagName&&"checkbox"===this.type?this.checked&&(k[this.name]="on"):k[this.name]=a(this).val()});
h.preventDefault();m.removeClass("active-tab");m.removeClass("point");l.addClass("preloader");a("#shop2-delivery-wait").show();a("input#address").blur();a("#shop2-deligate-calc").hide();a.ajax({url:"/my/s3/xapi/public/?method=deligate/calc&param[get_vars][]",type:"post",dataType:"json",data:k,success:function(q){l.removeClass("preloader");a("#shop2-delivery-wait").hide();a("#shop2-order-delivery").html(q.result.html);a("#shop2-order-delivery").append('<div class="preloader"><div class="spinner"></div></div>');
a("#shop2-order-delivery").find(".delivery-items").each(function(){var p=a(this);""==a.trim(p.text())&&p.parents(".shop2-delivery--item__tab:first").addClass("disabled")});if(q.result.error){e.alert(q.result.error);let p=e.my.on_shop2_btn?".shop2-btn":".g-button";a(".order_design_five").length&&(1>=a(".order_design_five  ul li").length&&a(".order_design_five  ul li").before(`<li>${q.result.error}</li>`),a(`.form-item ${p}`).addClass("shop2-disabled"),a(".order_design_five").removeClass("hide"))}else a.parseJSON(a("#dadata").val()),
q=e.my.on_shop2_btn?".shop2-btn":".g-button",a(".order_design_five ").length&&(1<a(".order_design_five  ul li").length&&a(".order_design_five  ul li").first().remove(),a(`.form-item ${q}`).removeClass("shop2-disabled"),a(".order_design_five").addClass("hide")),e.queue.edost2(),a("#shop2-ems-calc, #shop2-edost-calc").on("click",function(p){var v=a(this).data("attach-id"),x=a("select[name="+v+"\\[to\\]]"),u=a("input[name="+v+"\\[zip\\]]"),w=a("input[name="+v+"\\[order_value\\]]");0==x.length&&(x=a("#shop2-edost2-to"));
p.preventDefault();x=x.get(0)?x.val():"";u=u.get(0)?u.val():"";w=w.prop("checked")?"on":"";e.delivery.calc(v,"to="+x+"&zip="+u+"&order_value="+w,function(y){!y.data&&y.errstr?(e.alert(y.errstr),a("#delivery-"+v+"-cost").html(0)):(a("#delivery-"+v+"-cost").html(y.data.cost),y.data.html&&(a("#delivery-"+v+"-html").html(y.data.html),e.queue.edost()))})}),a("#shop2-deligate-calc").hide()}})})},coupon:function(){e.on("afterCartAddCoupon, afterCartRemoveCoupon",function(){document.location.reload()});a(".coupon-btn").on("click",
function(b){var c=a("#coupon").val();b.preventDefault();c&&e.cart.addCoupon(c)});a(".coupon-delete").on("click",function(b){var c=a(this).data("code");b.preventDefault();c&&e.cart.removeCoupon(c)})},delivery:function(){a("#shop2-order-delivery").find(".delivery-items").each(function(){var b=a(this);""==a.trim(b.text())&&b.parents(".shop2-delivery--item__tab:first").addClass("disabled")});a(document).on("change",".map-select select",function(){var b=a(this),c=b.find("option:selected").index();b.find("option:selected").text();
b=b.val();if(0==c)e.delivery.ymapsMap.balloon.close();else for(c=e.delivery.ymapsMap.geoObjects.getIterator();c=c.getNext();){for(var d=0,f=c.getLength();d<f;d++){var g=c.get(d);g.properties.get("id")===b?(g.options.set("iconImageHref",e.delivery.ymapsIconsData.selected),g.balloon.isOpen()?g.balloon.close():g.balloon.open()):g.options.set("iconImageHref",e.delivery.ymapsIconsData["default"])}break}});a(".shop2-payment-options .option-type").each(function(){if(a(this).hasClass("option-payment-systems")&&
a(this).hasClass("active-type")){var b=a(".shop2-payment-options .shop2-payment-btn");a(".shop2-payment-options .shop2-payment-btn").attr("data-continue-text");var c=a(".shop2-payment-options .shop2-payment-btn").attr("data-pay-text");b.text(c)}});a(document).on("click",".shop2-cart-order-payments .options-list .option-type:not(.active-type) .option-label.payments-label",function(b){b.stopPropagation();b=a(this);a(document).find(".shop2-cart-order-payments .option-type").removeClass("active-type");
b.parent().addClass("active-type")});a(document).on("click",".option-label:not(.payments-label)",function(b){var c=a(this),d=a(document).find(".option-label"),f=a(document).find(".option-type");d=d.next();c.parent().index();"INPUT"!=b.target.nodeName&&e.delivery.deligate&&"orders"!=e.mode&&b.preventDefault();e.delivery.ymapsMap&&(e.delivery.ymapsMap.destroy(),e.delivery.ymapsMap=null);b=e.my.on_shop2_btn?".shop2-btn":".g-button";c.hasClass("ymap")?a(`.form-item ${b}`).length&&(a(`.form-item ${b}`).addClass("shop2-disabled"),
a(".order_design_five").removeClass("hide")):a(`.form-item ${b}.shop2-disabled`).length&&(a(`.form-item ${b}.shop2-disabled`).removeClass("shop2-disabled"),a(".order_design_five").addClass("hide"));f.removeClass("active-type");c.parent().addClass("active-type");d.find("input, textarea, select").prop("disabled",!0);c.next().find("input, textarea, select").prop("disabled",!1);e.delivery.deligate&&c.find("input:first").prop("checked",!0);c.hasClass("ymap")&&e.delivery.YmapsInit(c.data("service-code"));
a(".shop2-payment-options .shop2-btn").hasClass("shop2-payment-btn")&&(f=a(".shop2-payment-options .shop2-payment-btn"),b=a(".shop2-payment-options .shop2-payment-btn").attr("data-continue-text"),d=a(".shop2-payment-options .shop2-payment-btn").attr("data-pay-text"),c.parent().hasClass("option-payment-systems")?f.text(d):f.text(b))});a(document).on("click",".shop2-delivery--item__tab .tab-label",function(){var b=a(document).find(".shop2-delivery--item__tab"),c=a(this).parents(".shop2-delivery--item__tab:first"),
d=c.index();if(c.hasClass("disabled"))return!1;c.hasClass("active-tab")?c.removeClass("active-tab"):(b.removeClass("active-tab").eq(d).addClass("active-tab"),b=a(".active-tab .tab-label").offset().top-10,a("html, body").animate({scrollTop:b},800))});a(document).on("click",".option-label:not(.payments-label)",function(){var b=a(this),c=b.data("attach_id"),d=b.parent().siblings(".option-type");b=b.parents(".shop2-delivery--item__tab:first").siblings();a("#delivery_id_deligate").val(c);a("#deligate_points_fields .fields").empty();
a("#deligate_points_fields").hide();b.find(".option-type input").prop("checked",!1);b.removeClass("point");d.find("input").prop("checked",!1)});a("#shop2-ems-calc, #shop2-edost-calc").on("click",function(b){var c=a(this).data("attach-id"),d=a("select[name="+c+"\\[to\\]]"),f=a("input[name="+c+"\\[zip\\]]"),g=a("input[name="+c+"\\[order_value\\]]");0==d.length&&(d=a("#shop2-edost2-to"));b.preventDefault();d=d.get(0)?d.val():"";f=f.get(0)?f.val():"";g=g.prop("checked")?"on":"";e.delivery.calc(c,"to="+
d+"&zip="+f+"&order_value="+g,function(h){!h.data&&h.errstr?(e.alert(h.errstr),a("#delivery-"+c+"-cost").html(0)):(a("#delivery-"+c+"-cost").html(h.data.cost),h.data.html&&(a("#delivery-"+c+"-html").html(h.data.html),e.queue.edost()))})})},edost:function(){function b(g){g="[name="+g.replace(/([\[\]])/g,"\\$1")+"]";return a(g)}function c(g){g=a.trim(g.text()).replace(/\s*\n\s*/g,"\n").split("\n").splice(1).join("\n");f.val(g).prop("readonly",!0)}var d=a("#shop2-edost-calc").data("attach-id"),f=b(d+
"[address]");b(d+"[edost][office]").on("click",function(){var g=a(this),h=g.closest(".shop2-edost-office");c(h);g.prop("checked",!0)});b(d+"[edost][tarif]").on("click",function(){var g=a(this).closest(".shop2-edost-variant"),h=g.siblings(),k=g.find(".shop2-edost-office");h.find(".shop2-edost-office input, .shop2-edost-pickpointmap input").prop({disabled:!0,checked:!1});h=g.find(".shop2-edost-office input, .shop2-edost-pickpointmap input").prop({disabled:!1}).filter(":radio");g=h.filter(":checked");
h.get(0)?g.get(0)?g.trigger("click"):h.eq(0).trigger("click"):1==k.length?c(k):f.prop("readonly")&&f.prop("readonly",!1).val("");e.trigger("afterEdostSet")}).filter(":checked").trigger("click");a(".shop2-edost-pickpointmap a").on("click",function(){var g=a(this),h=g.children(),k=g.data("city");g.closest(".shop2-edost-variant").find("> label input").trigger("click");PickPoint.open(function(l){var m={};a.each(["name","address","id"],function(q,p){m[p]=l[p]});g.next().val(JSON.stringify(m));h.html(": "+
m.name);f.val(m.name+",\n"+m.address).prop("readonly",!0)},{city:k,ids:null});return!1})},edost2:function(){function b(u){return a.map(u,function(w){return'<option value="'+w.id+'">'+w.name+"</option>"}).join("")}function c(u){u.html("").closest(".option-item").addClass("hide")}function d(u){u.closest(".option-item").removeClass("hide")}if(window.shop2EdostRegions){var f=a("#shop2-edost2-country"),g=f.html(),h=a("#shop2-edost2-region"),k=h.html(),l=a("#shop2-edost2-city"),m=l.html(),q=a("#shop2-edost2-to");
if(f.length){var p=a.grep(shop2EdostRegions,function(u){return u.is_country});f.html(g+b(p));c(h);c(l);f.on("change",function(){var u=a(this).val();h.length?(p=a.grep(shop2EdostRegions,function(w){return w.is_region&&w.country==u}),h.html(k+b(p)),0==p.length?(c(h),c(l),q.val(u)):(d(h),q.val(""))):l.length?(p=a.grep(shop2EdostRegions,function(w){return w.is_city&&w.country==u}),l.html(m+b(p)),0==p.length?(c(l),q.val(u)):(d(l),q.val(""))):q.val(u)})}h.length&&(f.length||(p=a.grep(shop2EdostRegions,
function(u){return u.is_region}),h.html(k+b(p)),c(l)),h.on("change",function(){var u=a(this).val();p=a.grep(shop2EdostRegions,function(w){return w.is_city&&w.region==u});l.html(m+b(p));0==p.length?c(l):d(l);q.val(u)}));f.length||h.length||(p=a.grep(shop2EdostRegions,function(u){return u.is_city}),l.html(k+b(p)));l.on("change",function(){var u=a(this).val();"default"===u?h.length&&q.val(h.val()):u&&q.val(u)});g=f.data("value");var v=h.data("value"),x=l.data("value");g&&f.val(g);f.trigger("change");
v&&h.val(v);h.trigger("change");x&&l.val(x);l.trigger("change")}},print:function(){a("#order-print").on("click",function(){s3.printMe("shop2-order",{stylesheet:e.options.printCSS});return!1})},hs:function(){a(".shop2-compare-product-image a img, .shop2-compare-data a img, .shop2-product .product-image a img, .shop2-product .product-thumbnails li a img, .cart-product-image a img, .cart-product-param a img").closest("a").on("click",function(){hs.expand(this);return!1}).addClass("highslide");a(document).on("click",
".shop2-edost-office-address a",function(){hs.htmlExpand(this,{objectType:"iframe",wrapperClassName:"draggable-header",outlineType:"rounded-white",width:900,height:600,align:"center"});return!1})},vendors:function(){a(".shop2-vendor").eachRow(function(b){var c=b.getHeights();b.each(function(d){var f=a(this);d=c.max-c.values[d];f=f.find(".vendor-name");var g=f.height();f.css("min-height",g+d)})})},toggleFields:function(){var b=a(".shop2-filter-fields"),c=readCookie("filter_opened"),d=a(".shop2-toggle-fields");
d.on("click",function(){var f=a(this),g=f.data("alt"),h=f.html();b.hasClass("hide")?createCookie("filter_opened",1,7):eraseCookie("filter_opened");b.toggleClass("hide");f.html(g);f.data("alt",h);return!1});c||d.trigger("click")},lazyLoad:function(){var b=a(document),c=a(window),d=!1,f=a(".product-list"),g=1E6;e.my.lazy_load_subpages&&f.get(0)&&b.scroll(function(){var h=a(".shop2-pagelist:last"),k=a(".product-list:last"),l=k.offset().top+k.height();"undefined"==typeof e.page&&(e.page=1);if(b.scrollTop()+
c.height()>=l&&!d&&e.page<g){d=!0;l="/my/s3/xapi/public/?method=shop2/lazyLoad";var m={param:{page_num:e.page,url:window.location.pathname}};window.location.search&&(l+="&"+window.location.search.substring(1));h.length&&1>a(".custom-shop2-pagelist").length&&a.ajax({url:l,type:"GET",dataType:"json",data:m,success:function(q){k.after("<hr />"+q.result.data.html);e.page=parseInt(e.page)+1;e.productRefs=Object.assign(e.productRefs,q.result.data.product_refs);g=q.result.data.pages;h.hide();e.queue.heights();
d=!1;e.trigger("afterProductsLazyLoaded")}})}})},compare:function(){a(document).on("click",".product-compare input:checkbox",function(){var b=a(this),c=b.attr("checked")?"del":"add";e.compare.action(c,b.val(),function(d,f){"success"==f&&(d.errstr?(e.alert(d.errstr),b.prop("checked",!1)):(a("input[type=checkbox][value="+b.val()+"]").closest(".product-compare").replaceWith(d.data),a(".product-compare-added a span").html("("+d.count+")"),d.panel&&a("#shop2-panel").replaceWith(d.panel)))})})},compareTable:function(){a(".shop2-compare-table").each(function(){var b=
a(this),c=b.find(".shop2-compare-switch a"),d=b.find(".shop2-compare-data");b.find(".shop2-compare-delete").on("click",function(){var f=a(this).data().id;e.compare.remove(f,function(){document.location.reload()});return!1});c.on("click",function(){var f=a(this);c.removeClass("shop2-compare-switch-active");f.addClass("shop2-compare-switch-active");0===f.index()?d.show():d.each(function(){var g=a(this);var h=g.find("td");var k=h.eq(1).html(),l=!1,m=2,q=h.length;if(2>=q)h=!1;else{for(;m<q;m+=1){if(k!=
h.eq(m).html()){l=!0;break}k=h.eq(m).html()}h=l}h?g.show():g.hide()});return!1}).eq(1).trigger("click")})},favorite:function(){a(document).on("click",".favorite_btn",function(){var b=a(this),c=b.parents("form").find('input[name="kind_id"]').val(),d=b.parents(".favorite_btn_wrapper").find(".favorite_btn_active");a.ajax({url:"/my/s3/xapi/public/?method=shop2/addFavoriteProduct&param[kind_id]="+c,type:"post",dataType:"json",data:c,success:function(f){f=f.result.count;a(".favorite_btn_active a > span").text(f);
a(".shop2_favorite_cart_link span").text(f);a(".favorite_panel").removeClass("not-null");e.msg("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u0432 <a href='%s'>\u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435</a>".replace("%s",e.uri+"/favorites"),b);b.hide();d.show()}})});a(document).on("click",".favorite_btn_active .icon",function(){var b=a(this).parents("form").find('input[name="kind_id"]').val();a('<div class="shop2-popup_favorite"><div class="popup_inner"><div class="text">\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440 \u0438\u0437 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e?</div><div class="btns"><div class="shop2-btn delete_fovorite" data-kind_id="'+
b+'">\u0423\u0434\u0430\u043b\u0438\u0442\u044c</div><div class="shop2-btn-close close_favorite">\u0417\u0430\u043a\u0440\u044b\u0442\u044c</div></div></div></div>').appendTo("body")});a(document).on("click",".delete_fovorite",function(){var b=a(this).data("kind_id"),c=a("body").find('form input[value="'+b+'"]').closest("form"),d=c.find(".favorite_btn"),f=c.find(".favorite_btn_active");a.ajax({url:"/my/s3/xapi/public/?method=shop2/removeFavoriteProduct&param[kind_id]="+b,type:"post",dataType:"json",
data:b,success:function(g){g=g.result.count;a(".favorite_btn_active a > span").text(g);a(".shop2_favorite_cart_link span").text(g);0==g&&a(".favorite_panel").addClass("not-null");f.hide();d.show()}});a(".shop2-popup_favorite").remove()});a(document).on("click",".close_favorite",function(){a(".shop2-popup_favorite").remove()});a(document).on("click",".shop2-btn_popup_favorite",function(b){a('<div class="shop2-popup_favorite"><div class="popup_inner"><div class="text">\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u0441\u0435 \u0442\u043e\u0432\u0430\u0440\u044b \u0438\u0437 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0433\u043e?</div><div class="btns"><div class="shop2-btn clear_fovorite">\u0423\u0434\u0430\u043b\u0438\u0442\u044c</div><div class="shop2-btn-close close_favorite">\u0417\u0430\u043a\u0440\u044b\u0442\u044c</div></div></div></div>').appendTo("body");
b.preventDefault()});a(document).on("click",".clear_fovorite",function(b){a.ajax({url:"/my/s3/xapi/public/?method=shop2/clearFavoriteProducts",type:"post",dataType:"json",success:function(c){}});location.reload()})},paySelected:function(){if("orders"==e.mode&&a("[data-continue-text]").length)a(".options-list input").on("change",function(b){b=a(this);var c=a("[data-continue-text]"),d=c.data("continue-text"),f=c.data("pay-text");b.hasClass("shop2-payments-radio")?c.text(d):c.text(f)})},buyOneClick:function(){function b(){"undefined"!=
typeof shop2_gr&&"undefined"!=typeof shop2_gr.methods.amountInit&&shop2_gr.methods.amountInit()}function c(){"undefined"!=typeof grFormDatePicker?grFormDatePicker.init():a(".datepickerInit").each(function(k,l){a(this).datepicker({minDate:0,changeMonth:!1,numberOfMonths:1})})}function d(k){k=k.closest(".shop2-buy-one-click__product-right");var l=+String(k.find(".shop2-buy-one-click__total").data("price")).replace(/\u00A0/g,"");k.find(".shop2-product-amount input").data("min");var m=+k.find(".shop2-product-amount input").val();
l*=m;k.find(".shop2-buy-one-click__total .price-current strong").text(Math.floor(l).toString().replace(/\B(?=(\d{3})+(?!\d))/g," "))}function f(k){let l=k.requestType||"post";if("get"==l){var m="/my/s3/xapi/public/?method=shop2/buyOneClick&param[kind_id]="+g.kind_id,q=a(h.str_btn).data("images-size"),p=a(h.str_btn).data("images-view");p&&(m+="&gr_images_view="+p);q&&(m+="&gr_images_size="+q);a.ajax({url:m,type:l,cache:!1,dataType:"json"}).done(function(v){k.callback&&k.callback(v)})}else{m="/my/s3/xapi/public/?method=shop2/buyOneClick";
q=k.serializeData;p=a(h.str_btn).data("images-size");let v=a(h.str_btn).data("images-view");v&&(m+="&gr_images_view="+v);p&&(m+="&gr_images_size="+p);a.ajax({url:m,data:q,type:l,cache:!1,dataType:"json"}).done(function(x){if(x.result.error)return a(h.str_block+" .shop2-warning").remove(),a(h.str_block+" .shop2-buy-one-click__result").prepend('<div class="shop2-warning">'+x.result.error+"</div>"),h.up_scroll(),!1;if(x.result.redirect_payment_url)return window.location.replace(x.result.redirect_payment_url),
!1;let u=a.trim(x.result.html).replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");a(h.str_block).find(".shop2-buy-one-click-block").html(u);c();a(".order_one_click_amount_js input").trigger("change");b();k.callback&&k.callback(x)})}}if(a(".buy-one-click-js").length){var g={status_modal:!1};if(a('[data-remodal-id="buy-in-one-click"]').length){var h=a('[data-remodal-id="buy-in-one-click"]').remodal();h.str_block='[data-remodal-id="buy-in-one-click"]';h.str_btn=".buy-one-click-js";h.settings.hashTracking=
!1;h.open_modal=function(k){a(this.str_block).find(".shop2-buy-one-click-block").html(k);this.open()};h.up_scroll=function(){this.$wrapper.scrollTop(0)}}else{h={str_block:".buy-one-click-container",str_btn:".buy-one-click-js",open_modal:function(m){g.opening(`
				<div class="${this.str_block.replace(".","")}">
					<div class="preorder-form-close"></div>
					<div class="shop2-buy-one-click-block">${m}</div>
				</div>
				`)},up_scroll:function(){a(this.str_block).parent().parent().scrollTop(0)}};a(document).on("keyup.esc_keyup",function(m){27==m.keyCode&&g.status_modal&&k.apply(g);return!1});a(document).on("click",function(m){m.stopPropagation();m=a(m.target);(m.is(".buy-one-click-container .preorder-form-close")||m.is(".shop2-buy-one-click-popup"))&&k.apply(g)});function k(){a("html").removeClass("oveflowHidden");this.current_modal.removeClass("opened");this.status_modal=!1}function l(){a("html").addClass("oveflowHidden");
this.current_modal.addClass("opened");this.status_modal=!0}(function(){window.$popup=a('<div class="shop2-buy-one-click-popup">\n\t\t\t\t\t<div class="shop2-buy-one-click-popup__inner">\n\t\t\t\t\t</div>\n\t\t\t\t</div>');a("body").append($popup);g.current_modal=$popup;g.opening=function(m){this.current_modal.find(".shop2-buy-one-click-popup__inner").html(m);l.apply(this)}})()}a(document).on("click",h.str_block+" .order_one_click_amount_js",function(k){k=a(k.target);(k.hasClass("amount-plus")||k.hasClass("amount-minus"))&&
d(k)});a(document).on("change",".order_one_click_amount_js input",function(){var k=a(this);setTimeout(function(){d(k)},100)});a(document).on("click",h.str_btn,function(k){k.preventDefault();g._this=this;g.kind_id=+a(g._this).data("product-kind_id");g.form=a(g._this).closest("form");f({requestType:"get",callback:function(l){l=a.trim(l.result.html).replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");h.open_modal(l);c();a(".order_one_click_amount_js input").val(g.form[0].amount.value).trigger("change");
b()}})});a(document).on("submit",h.str_block+" form",function(k){k.preventDefault();k=a(this).serializeArray();var l=!0;a(h.str_block+" .order_field_email").each(function(){var m=a(this).val();if(!/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(String(m).toLowerCase()))return a(this).closest(".tpl-field").addClass("field-error").find(".error-message").removeClass("hide"),l=!1});l&&f({requestType:"post",serializeData:k})})}},
alert:function(){function b(){f.hide();d.hide();d.removeAttr("class");c="";e.trigger("alertHide",d);return!1}var c;a(document.body).append('<div id="shop2-alert">\n<div id="shop2-alert-body"></div>\n<a href="#" id="shop2-alert-ok" class="shop2-btn"></a>\n</div>\n<div id="shop2-alert-overlay"></div>');var d=a("#shop2-alert");var f=a("#shop2-alert-overlay");var g=a("#shop2-alert-body");var h=a("#shop2-alert-ok");f.on("click",b);h.on("click",b);e.alert=function(k,l,m){h.html(l||"Ok");g.html(k);c=m||
"shop2-alert--warning";f.show();d.attr("class",c);d.show().s3center();e.trigger("alertShow",d)};e.alert.hide=b},tooltip:function(){a(".shop2-tooltip").s3tooltip({cls:"shop2-color-ext-tooltip",dir:"top",data:function(){return a(this).data("tooltip")}})},colorTooltip:function(){a(".shop2-color-ext-list li").s3tooltip({cls:"shop2-color-ext-tooltip",dir:"top",data:function(){return a(this).children("div").html()}});a(".shop2-color-ext-multi").s3tooltip({cls:"shop2-color-ext-tooltip shop2_multi_tooltip",
dir:"top",data:function(){var b=this.getElementsByTagName("ul");if(b.length)return b[0].outerHTML}})},colorPopup:function(){var b=a('<div id="shop2-color-ext-popup"></div>'),c=a('<div id="shop2-color-ext-close"></div>'),d=a('<ul id="shop2-color-ext-list" class="shop2-color-ext-list"></ul>'),f=null;b.append(c);b.append(d);a(document.body).append(b);a.on(".shop2-color-ext-caption",{click:function(){var g=a(this),h=g.closest(".shop2-color-ext-popup").find(".shop2-color-ext-list");g=g.offset();f=h.children("li");
d.html(h.html());b.css(g).show();return!1}});a(document).on("click",".shop2-color-ext-list li",function(){var g=a(this),h=g.data(),k=g.parent().find("input.additional-cart-params"),l=g.is(".shop2-color-ext-selected");"undefined"!==typeof h.kinds||k.length?(g.addClass("shop2-color-ext-selected").siblings().removeClass("shop2-color-ext-selected"),k.length?k.val(h.value):l||e.product._reload(this)):(k=g.index(),g.closest("#shop2-color-ext-popup").length&&(g.toggleClass("shop2-color-ext-selected"),f.eq(k).toggleClass("shop2-color-ext-selected"),
e.filter.toggle(h.name,h.value),e.filter.count()))});a(document).on("click",function(g){a(g.target).closest("#shop2-color-ext-popup").get(0)&&g.target!=c.get(0)||b.hide()})},colorSelect:function(){function b(){if(c.is(":visible"))return c.hide(),!0}var c=a('<div id="shop2-color-ext-select"><ins></ins></div>'),d=null,f=null;a(document.body).append(c);a(document).on("click",b);a.on(".shop2-color-ext-select",{click:function(){if(!b()){var g=a(this),h=g.find(".shop2-color-ext-options"),k=g.offset(),l=
'<div class="baron-wrapper"> <div class="baron-scroller">   <div class="baron-container">     <div class="shop2-color-ext-options">'+h.html()+'     </div>   </div>   <div class="baron-scroller-bar"></div> </div></div>';d=h.children("li");f=g.find("input");c.html(l);c.show();g=g.width();(h=c.data("width"))||(h=c.width(),c.data("width",h));g>h?c.css("width",g):c.css("width",h);baron(c,{scroller:".baron-scroller",container:".baron-container",bar:".baron-scroller-bar"});c.css(k);return!1}}});a.on("#shop2-color-ext-select li:not(.shop2-color-ext-selected)",
{click:function(){var g=a(this),h=g.index(),k=g.data();g.addClass("shop2-color-ext-selected").siblings().removeClass("shop2-color-ext-selected");d.removeClass("shop2-color-ext-selected");d.eq(h).addClass("shop2-color-ext-selected");k.kinds?e.product._reload(d.get(h)):(f.val(k.value),a(f).closest(".search-form").length||e.cf_margin_price_enabled&&e.margin_price.price_change(f,"form"),g.hasClass("js-calc-custom-fields")&&e.product._reload(d.get(h)))}});a.on(".js-calc-custom-fields",{change:function(){var g=
a(this);e.product._reload(g.find(":selected").parent())}});a.on(".shop2-color-ext-list .js-calc-custom-fields:not(select)",{click:function(){var g=a(this);e.product._reload(g.parent())}})},coordinates:function(){a(document).on("click",".shop2-map-link",function(b){b.preventDefault();b=a(this);var c=b.data(),d=c.map;d.title||(d.title=b.text());e.maps.alert(c.mapType,d)})},fixDoubleOrders:function(){var b=a(".shop2-order-form, .shop2-order-in-one-page-form"),c=b.find("[type=submit]");b.on("submit",
function(){c.prop("disabled",!0);setTimeout(function(){c.prop("disabled",!1)},1E3)})},paymentMethods:function(){var b=a(".shop2-payment-type input"),c=a(".shop2-payment-methods input");b.on("change",function(){var d=a(this).closest(".shop2-payment-type").next(".shop2-payment-methods").find("input:first");c.prop("checked",!1);d.prop("checked",!0)});c.on("change",function(){var d=a(this).closest(".shop2-payment-methods").prev(".shop2-payment-type").find("input:first");b.prop("checked",!1);d.prop("checked",
!0)})},auth:function(){a(document).on("click",".js-shop2-cart-auth__expand",function(b){b.preventDefault();a(".js-shop2-cart-auth__form").toggle()})},orderGetPayments:function(b,c){b=b||!1;c=c||!1;if(6==e.shop2_cart_order_payments){var d=a(".shop2-order-options.shop2-delivery"),f=d.find(".option-type");d=d.find('.option-label [name="delivery_id"]');var g=a(".shop2-cart-order-payments");function h(k,l){var m=this.value;k=this.property_attach||0;var q=this.tarif||0,p=this.delivery_type||0;m&&(m={attach_id:m,
html:!0,mode:"one-page"},k?m.attach=k:q&&(m.deligate={},m.deligate.tarif=q),p&&(m.attach={delivery_type:p,deligate:{tarif:this.tarif,pos:this.pos,code:this.code,insurance_type:this.insurance_type,tariff_id:this.tariff_id}}),a.ajax({method:"GET",url:"/my/s3/xapi/public/?method=shop2/getPayments",data:{param:m},success:function(v){"undefined"!=typeof v.result&&"undefined"!=typeof v.result.html?(g.html(v.result.html),"undefined"!=typeof l&&l()):"undefined"!=typeof v.error&&v.error.message&&g.html(v.error.message);
e.trigger("afterGetDeliveryPayments")}}))}if(!b&&(d.on("click",h),a("#shop2-order-delivery .tab-label").length&&(a(document).on("click","#shop2-order-delivery .option-type:not(.active-type)",function(k){k={};var l=a(this);let m=l.find(".option-label"),q=m.find("input")[0];k.value=m.data("attach_id");"undefined"!=typeof l.attr("data-option-for-paymethod")?(l=l.attr("data-option-for-paymethod"),l=JSON.parse(l),k.delivery_type=l.delivery_type,k.value=l.attach_id,k.tarif=l.tariff_hash,k.pos=l.pos,k.code=
l.code,k.insurance_type=l.insurance_type,k.tariff_id=l.tariff_id):q.name.match("tarif")&&(k.tarif=q.value);h.call(k,"")}),a(".shop2-warning").hasClass("hide")))){let k=a("#shop2-order-delivery .option-type").filter(".active-type");k.trigger("click");k.closest(".shop2-delivery--item__tab").addClass("active-tab");6==e.shop2_cart_order_payments&&e.queue.orderGetPayments(!0,k.find('[name="delivery_id"]')[0])}g.length&&d.length&&!localStorage.getItem("delivery_item_active")&&(f=f.filter(".active-type").find('.option-label [name="delivery_id"]'),
h.call(f,"",()=>{let k=g.attr("data-payment_id")||!1;if(k){var l=g.find('.option-label [name="payment_id"]');l.first().removeAttr("checked");l=l.filter(function(m,q){return a(q).val()==k||a(q).val()=="-"+k});l.attr("checked","checked");l.closest(".option-type").addClass("active-type").siblings().removeClass("active-type")}}));b&&h.call(c)}}};e.cart.applyBonusPoint=function(b,c){e.trigger("beforeCartApplyBonus");a.getJSON("/my/s3/xapi/public/?method=cart/applyBonusPoints",{param:{hash:e.hash.cart,
bonus_points:b}},function(d,f){e.fire("afterCartApplyBonusPoints",c,d,f);e.trigger("afterCartApplyBonusPoints",d,f)});return!1};e.cart.removeBonusPoint=function(b){e.trigger("beforeCartRemoveCartBonusPoints");a.getJSON("/my/s3/xapi/public/?method=cart/RemoveBonusPoints",{param:{hash:e.hash.cart}},function(c,d){e.fire("afterCartRemoveCartBonusPoints",b,c,d);e.trigger("afterCartRemoveCartBonusPoints",c,d)})};e.margin_price={price_change:function(b,c){if("cart"==e.mode)f=a("#shop2-cart"),e.cart.update(f);
else{var d=a(b).closest(c),f=d.get(0);b=d.find(".additional-cart-params");c=b.length;var g={kind_id:f.kind_id.value,params:{}};if(c)for(var h=0;h<c;h+=1)f=b[h],f.value&&(g.params[f.name]=f.value);a.ajax({url:"/my/s3/xapi/public/?method=shop2/getPrice",type:"get",data:{param:g},dataType:"json",success:function(k){d.find(".price-current").replaceWith(k.result.data.html.price);d.find(".price-old ").replaceWith(k.result.data.html.price_old)}})}},select_change:function(){if(e.cf_margin_price_enabled&&
(a(document).on("click",".shop2-color-ext-list li",function(){var b=a(this);setTimeout(function(){e.margin_price.price_change(b,"form")},10)}),a("select.additional-cart-params").length))a.on("select.additional-cart-params",{change:function(b){e.margin_price.price_change(a(b.target),"form")}})}};e.queue.margin_price=function(){if("cart"==e.mode&&!a("#delivery_id_deligate").length){if(localStorage.getItem("delivery_item_active")){let b=a(".shop2-order-in-one-page-form .shop2-delivery .options-list .option-type").eq(+localStorage.getItem("delivery_item_active")).find(".option-label");
b.trigger("click").addClass("active-type");e.queue.orderGetPayments(!0,b.find('[name="delivery_id"]')[0])}else 6==e.shop2_cart_order_payments&&a(".shop2-order-in-one-page-form .shop2-delivery > .options-list > .option-type.active-type > .option-label input").trigger("click");a(".shop2-order-in-one-page-form .shop2-delivery .options-list .option-type .option-label").on("click",function(){let b=a(".shop2-order-in-one-page-form .shop2-delivery .options-list .option-type.active-type").index();localStorage.setItem("delivery_item_active",
b)})}e.margin_price.select_change()};e.queue.bonus=function(){e.on("afterCartApplyBonusPoints, afterCartRemoveCartBonusPoints",function(){document.location.reload()});a(".bonus-apply").on("click",function(b){var c=a("#bonus-points");c=Number(c.val());var d=Number(a(".bonus-amount").html());switch(!0){case ""==c||c>d:b.preventDefault();break;case d>=c:e.cart.applyBonusPoint(c)}});a(".bonus-delete").on("click",function(b){e.cart.removeBonusPoint()});a.fn.inputFilter=function(b){return this.on("input keydown keyup mousedown mouseup select contextmenu drop",
function(){b(this.value)?(this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")&&(this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd))})};a("#bonus-points").inputFilter(function(b){return/^\d*$/.test(b)})};var t=e.maps={};t.alert=function(b,c){e.alert('<div id="shop2-alert-map"></div>',"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","shop2-alert--map");t[b].ready(function(){t[b].draw("shop2-alert-map",
c)})};t.getCenter=function(b){a.each(b,function(){})};t.yandex={ymaps:window.ymaps,_loading:a.Deferred(),_loading_init:!1,_loading_callback:function(b){this.ymaps=b;this._loading.resolve(b)},ready:function(b){this._loading.done(b);this.ymaps?this._loading.resolve(this.ymaps):this._loading_init||(""!=e.maps_yandex_key?a("head").append('<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&onload=shop2.maps.yandex._loading_callback&apikey='+e.maps_yandex_key+'" type="text/javascript">'):a("head").append('<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&onload=shop2.maps.yandex._loading_callback" type="text/javascript">'),
this._loading_init=!0)},draw:function(b,c){c=a.extend({},c);c.title=a.s3escape(c.title);c.text=a.s3escape(c.text);b=new this.ymaps.Map(b,{zoom:c.z,center:[c.x,c.y],behaviors:["drag","rightMouseButtonMagnifier","scrollZoom"]});var d=this.ymaps.templateLayoutFactory.createClass('<div class="shop2-map-baloon-content"><h3>$[properties.title]</h3>$[properties.text]</div>');c=new A.ymaps.Placemark([c.x,c.y],c,{balloonContentLayout:d});b.geoObjects.add(c)}};t.google={gmaps:window.google&&window.google.maps?
window.google.maps:!1,_loading:a.Deferred(),_loading_init:!1,_loading_callback:function(){try{this.gmaps=window.google.maps,this._loading.resolve(this.gmaps)}catch(b){console.log(b)}},ready:function(b){this._loading.done(b);this.gmaps?this._loading.resolve(this.gmaps):this._loading_init||(a("head").append('<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&callback=shop2.maps.google._loading_callback&key='+e.maps_google_key+'" type="text/javascript">'),this._loading_init=!0)},draw:function(b,
c){var d=new this.gmaps.Map(document.getElementById(b),{zoom:Number(c.z),center:new google.maps.LatLng(c.x,c.y)}),f=new google.maps.Marker({position:new google.maps.LatLng(c.x,c.y),map:d,title:c.title}),g=new google.maps.InfoWindow({content:'<div class="shop2-map-baloon-content"><h3>'+a.s3escape(c.title)+"</h3>"+a.s3escape(c.text)+"</div>"});this.gmaps.event.addListener(f,"click",function(){g.open(d,f)})}};a(window).on("load",function(){e.queue.heights();e.product.productDatePicker()});A.shop2=e;
a(function(){var b=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/i.test(navigator.userAgent)?"touchend.respons":"click.respons";a(".personal-html-btn, .close-btn").on(b,function(c){c.preventDefault();a(".personal-html-content").toggleClass("active")});a(document).on("click",".btn_payment_rest",function(){a(".shop2-order-options-wrapper").slideToggle()});a(document).on(b,function(c){a(c.target).closest(".personal-html-content-in, .personal-html-btn").length||a(".personal-html-content").removeClass("active")});
a(this).keydown(function(c){27==c.which&&a(".personal-html-content").removeClass("active")});a(document).on("click","#shop2-color-ext-select li",function(){e.facets.enabled&&setTimeout(function(){var c="/my/s3/api/shop2/?cmd=getSearchMatches&hash="+e.apiHash.getSearchMatches+"&ver_id="+e.verId+"&"+a(e.facets.search.wrapper).serialize();e.facets.getDataSearch(c)},100)});a(document.body).on("change",".shop2-block.search-form #shop2_search_custom_fields select, .shop2-block.search-form #shop2_search_custom_fields input",
function(){e.facets.enabled&&setTimeout(function(){var c="/my/s3/api/shop2/?cmd=getSearchMatches&hash="+e.apiHash.getSearchMatches+"&ver_id="+e.verId+"&"+a(e.facets.search.wrapper).serialize();e.facets.getDataSearch(c)},100)})})})(jQuery,window);